(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{495:function(s,n,t){"use strict";t.r(n);var a=t(40),e=Object(a.a)({},(function(){var s=this,n=s.$createElement,t=s._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"amazon-nlb"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#amazon-nlb"}},[s._v("#")]),s._v(" Amazon NLB")]),s._v(" "),t("h2",{attrs:{id:"network-load-balancer"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#network-load-balancer"}},[s._v("#")]),s._v(" Network Load Balancer")]),s._v(" "),t("ul",[t("li",[s._v("AWS opensource blog")])]),s._v(" "),t("blockquote",[t("p",[t("a",{attrs:{href:"https://aws.amazon.com/ko/blogs/opensource/network-load-balancer-nginx-ingress-controller-eks/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://aws.amazon.com/ko/blogs/opensource/network-load-balancer-nginx-ingress-controller-eks/"),t("OutboundLink")],1)])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://quip-amazon.com/blob/bGA9AAmviCK/RxIsFh8j-vQYBvmZWBNpOw?a=gc7lDKxZ4JUQcZcn1Ojr4h0axnP0cmkLy1LWdZ3fuDga",width:"550px",height:"580px",title:"nlb",alt:"nlb"}}),t("br")]),s._v(" "),t("h3",{attrs:{id:"nginx-ingress-controller"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nginx-ingress-controller"}},[s._v("#")]),s._v(" NGINX Ingress Controller")]),s._v(" "),t("h4",{attrs:{id:"alb-ingress-controller-대신-nginx-ingress-controller-기반의-amazon-nlb-사용"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#alb-ingress-controller-대신-nginx-ingress-controller-기반의-amazon-nlb-사용"}},[s._v("#")]),s._v(" ALB Ingress Controller 대신, NGINX Ingress Controller 기반의 Amazon NLB 사용")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("기본적으로 NGINX Ingress Controller 는 모든 namespace 의 모든 수신 이벤트를 수신하고 해당 지시문과 규칙을 NGINX 구성 파일에 추가합니다. 이를 통해 모든 수신 규칙, 호스트 및 경로를 포함하는 중앙 집중식 라우팅을 사용할 수 있습니다.")])]),s._v(" "),t("li",[t("p",[s._v("NGINX Ingress Controller 를 사용하면 동일한 Network Load Balancer 를 사용하는 여러 환경 또는 namespace 에 대한 여러 수신 객체를 가질 수도 있습니다. ALB를 사용하는 경우 각 수신 개체에는 새로운 로드 밸런서가 필요합니다."),t("br"),s._v("\n또한, NGINX 인 그레스 컨트롤러와 함께 사용할 경우 경로 기반 라우팅과 같은 기능을 NLB에 추가 할 수 있습니다.")])])]),s._v(" "),t("h2",{attrs:{id:"deploy-nginx-ingress-controller"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#deploy-nginx-ingress-controller"}},[s._v("#")]),s._v(" Deploy NGINX Ingress Controller")]),s._v(" "),t("ul",[t("li",[s._v("아래 manifest 를 deploy 시, EKS Cluster 에 NGINX Ingress Controller 를 설치 및 Amazon NLB 가 실행됨")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("$ kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-0.32.0/deploy/static/provider/aws/deploy.yaml\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[s._v("배포 내역")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("$ kubectl get svc -n ingress-nginx\nNAME                                 TYPE           CLUSTER-IP      EXTERNAL-IP       PORT(S)                      AGE\ningress-nginx-controller             LoadBalancer   10.100.86.111   <external ip>   80:30840/TCP,443:30757/TCP   2d17h\n\n$ kubectl get po -n ingress-nginx\nNAME                                       READY   STATUS    RESTARTS   AGE\ningress-nginx-controller-98f46f89d-7c74g   1/1     Running   0          2d\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h2",{attrs:{id:"create-ingress-on-eks-cluster"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#create-ingress-on-eks-cluster"}},[s._v("#")]),s._v(" Create Ingress on EKS Cluster")]),s._v(" "),t("ul",[t("li",[s._v("Ingress YAML 설정 및 생성\n"),t("ul",[t("li",[s._v("kubernetes.io/ingress.class"),t("br"),s._v("\n: nginx ingress controller 의 class 인 nginx 로 설정")])])]),s._v(" "),t("li",[s._v("ALB 사용 시 설정했던, subnet / security group 지정 필요 없음")])]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" extensions/v1beta1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Ingress\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" <app name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("annotations")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kubernetes.io/ingress.class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nginx.ingress.kubernetes.io/ssl-redirect")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"false"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nginx.ingress.kubernetes.io/force-ssl-redirect")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"false"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("rules")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("host")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" <host name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("http")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("paths")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("path")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" <path name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("backend")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("serviceName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" <app name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("servicePort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" <port"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("ul",[t("li",[s._v("(Optional) Hosted Zone 설정\n"),t("ul",[t("li",[s._v("AWS Console에서 Route 53 Hosted Zone 에서, Domain 이 Amazon NLB 를 가리키도록 설정 가능"),t("br"),s._v(" "),t("a",{attrs:{href:"https://console.aws.amazon.com/route53/v2/hostedzones#",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://console.aws.amazon.com/route53/v2/hostedzones#"),t("OutboundLink")],1)])])])])])}),[],!1,null,null,null);n.default=e.exports}}]);